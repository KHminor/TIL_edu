# 스위치 근거리 네트워크1 

## 링크 계층 주소체계와 ARP

호스트와 라우터들은 네트워크 계층 주소(IP)를 가지고 있는데 

사실 호스트와 라우터들은 네트워크 계층 주소 뿐만 아니라 링크 계층의 주소도 가진다고 한다.



그런데 호스트와 라우터들은 모두(네트워크 계층 주소, 링크 계층의 주소)를 필요로 하는가 하면



### MAC 주소 (링크 계층 주소)

우선 실제로 링크 계층 주소를 가지는 것은 호스트나 라우터가 아닌 

호스트나 라우터의 `어댑터(네트워크 인터페이스)`이다.

여기서 어댑터란 LAN을 의미한다.

또한 링크 계층 주소를 `랜 주소 또는 MAC 주소`라고 한다.

* 대부분 랜의 경우 MAC 주소의 길이가 6Byte이기에 2^48개 만큼 사용 가능한 랜 주소가 존재한다고 한다.
* 그래서 6Byte의 주소는 주로 16진수로 표기되며, 주소의 각 비트는 2개의 16진수로 표현된다고 한다.
* 또한 MAC 주소는 어떤 어댑터도 동일한 주소를 갖지 않는 유일한 주소를 가진다는 점. (IEEE가 MAC주소 공간을 관리하기 때문)
* 또한 어댑터의 MAC주소는 평면 구조를 가지고 있어 어댑터의 위치에 따라 변경되지 않는다고 한다.
  * 즉 이더넷 카드가 있는 휴대용 컴퓨터는 어디에 있든지 항상 동일한 MAC주소를 갖는다는 의미.



정리하자면

* 어댑터의 MAC 주소는 사람의 주민등록번호와 같은 느낌이며 
* IP 주소는 사람이 살고 있는 우편 주소와 유사한 느낌을 준다. 
* 우편 주소와 주민등록번호 두 가지를 다 가지는 것이 사람을 찾는 데 유용한 것처럼, 
* 호스트와 라우터 인터페이스 역시 네트워크 계층 주소와 MAC 주소를 모두 가지는 것이 유용하다



따라서 다수의 네트워크 인터페이스를 가지고 있는 호스트나 라우터는 같은 서브넷 안에 여러 개의 링크 계층 주소를 가지게 되지만

링크 계층 스위치는 호스트나 라우터를 연결해주는 인터페이스에 링크 계층 주소를 할당받지 않았는데 

이유는 링크 계층 스위치는 호스트와 라우터 간에 데이터그램을 전달하는 일만을 하기 때문이다.



그래서 아래의 그림을 보면, 스위치가 아닌 

각 호스트나 라우터에만 링크 계층 주소가 할당되어 있다는 것을 알 수 있다.

<img src="C:\Users\my\AppData\Roaming\Typora\typora-user-images\image-20221214221106884.png" alt="image-20221214221106884" style="zoom:80%;" />



그래서 MAC 주소가 필요한 이유를 한번 더 정리하자면

* 송신자는 MAC 주소를 프레임에 넣고 랜상으로 전송하며
* 수신자는 해당 MAC주소와 자신의 MAC주소가 일치할 때만 
* 해당 프레임을 상위 계층인 네트워크 계층으로 전달하기 때문이다.



---



### ARP(Address Resolution Protocol)

* ARP
  * IP 주소를 MAC 주소로 변환.
  * 네트워크 상에서 IP주소를 물리적 네트워크 주소(MAC)로 대응시키기 위해 사용되는 프로토콜



* RARP
  * 호스트의 물리적 주소로부터 IP 주소를 구할 수 있도록 하는 프로토콜



<img src="링크 계층 주소체계와 ARP.assets/image-20221214222916103.png" alt="image-20221214222916103" style="zoom:80%;" />

위 그림의 상황에서 

- IP 주소 222.222.222.220을 가진 호스트가 
- 동일한 서브넷에 존재하는 호스트 222.222.222.222로 IP 데이터그램을 전송한다면 



데이터그램을 전송하기 위해서는 출발지 노드는 반드시 자신의 어댑터에게 IP 데이터그램뿐만 아니라 

목적지 222.222.222.222의 MAC 주소도 알려주어야 합다. 

그래야 송신 어댑터가 목적지의 MAC 주소가 포함된 링크 계층 프레임을 구성해서 그 프레임을 랜으로 전송할 수 있기 때문.

 

그런데 이 때, **송신 호스트가 IP 주소 222.222.222.222를 가진 호스트의 MAC 주소를 결정할 수 있는 이유는? 바로 ARP**.

 

송신 호스트의 ARP 모듈은 입력값으로서 동일한 랜상의 임의의 IP 주소를 받아서 대응되는 MAC 주소를 리턴한다. 
위의 예시에서 송신 호스트 222.222.222.220가 자신의 ARP 모듈에게 IP 주소 222.222.222.222를 주면, 
ARP 모듈은 대응하는 MAC 주소 49-BD-D2-C7-56-2A를 리턴. 



## 이더넷



### 이더넷이란?

* 원칙적으로 하나의 인터넷 회선에 유/무선 통신장비 공유기, 허브 등을 통해 
  	다수의 시스템이 랜선 및 통신포트에 연결되어 통신이 가능한 네트워크 구조를 의미.

* OSI 7계층 중 물리 계층과 데이터 링크 계층에서 그 구성 형식이 정의된다.

* 이더넷 통신 방식중 중요한 방식인 `CSMA / CD`(Carrier Sense Multiple Access/ Collision Detection) 방식.

  * 즉 충돌 감지 원리 
  * 유사한 방식은 CSMA / CA (Carrier Sense Multiple Access/ Collision Avoidance)로 충돌 회피가 있다.

* 그래서 CSMA/CD의 원리는

  <img src="링크 계층 주소체계와 ARP.assets/image-20221214223745647.png" alt="image-20221214223745647" style="zoom:67%;" />

  1. 보낸 사람은 케이블의 신호와 이력을 확인하고, 다른 사람에게 신호가 흐르고 있지않음을 확인 후 전송을 시작한다.
  2. 전송 중에도 파형에 의해 다른 사람의 송신과 충돌하지 않는지를 감시하며, 
      만약 충돌하는 경우에는 일정량의 전송 후 중단하고 각 보낸 사람마다 일정 시간의 딜레이를 두고 전송을 재시작 한다. 

  (하나의 회선을 다수가 공유하거나, 많은 데이터를 다운로드를 하게 되면, 속도가 느려지듯이 자체적으로 CSMA / CD 방식으로 제어를 한다고 보시면 된다)



### 이더넷(Ethernet) 시스템 규격

통신이 가능한 랜선의 데이터 전송 속도를 정의하는 것으로

가장 많이 사용하는 3가지 종류

* 1000BASE-T 
* 100BASE-TX
* 10BASE-T 

<img src="링크 계층 주소체계와 ARP.assets/image-20221214223958126.png" alt="image-20221214223958126" style="zoom:67%;" />







* 10 BASE 2: 얇은 동축 케이블을 이용하며, 2는 세그먼트의 최장거리가 200m
* 10 BASE 5: 굵은 동축 케이블을 이용하며, 5는 세그먼트의 최장거리가 500m
* 10 BASE F: 광섬유 케이블을 이용하는 이더넷
* 10 BASE T: 10MBps의 전송 속도, 베이스 밴드 방식, Twisted Pair Wire 케이블 사용
* 고속 이더넷(Fast Ethernet): 100 BASE T 라고 불리는 이더넷의 고속 버전
* 기가비트 이더넷(Gigabit Ethernet): 1Gbps의 전송속도를 지원



